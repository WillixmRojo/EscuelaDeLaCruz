import{b as Y,a3 as pe,aM as xe,a5 as _e,x,d as b,aN as Se,a7 as ke,aO as Ce,a8 as Te,aP as Be,k as H,n as M,a2 as G,Y as R,s as Ve,h as O,ap as qe,g as Pe,f as Ne,H as $e,D as Ee,b5 as J,K as A,b6 as $,o as w,T as C,M as f,a as d,w as v,ai as m,ah as p,N as k,aj as X,P as T,m as Oe,b7 as I,b8 as Ae,b4 as Qe,c as Ue,ag as E,Q as De}from"./index.89684733.js";import{b as je,v as W,d as ze,p as Z,e as Le,f as He,r as F,s as Me,g as Ge,Q as Re}from"./QSelect.a221d0ae.js";import{c as K}from"./selection.a251d4ea.js";import{u as q}from"./use-quasar.3d3b91ab.js";import{T as V}from"./TGCLoading.989962c3.js";import{Q as Ie}from"./QToolbarTitle.53e50776.js";var We=Y({name:"QTooltip",inheritAttrs:!1,props:{...je,...pe,...xe,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:W},self:{type:String,default:"top middle",validator:W},offset:{type:Array,default:()=>[14,14],validator:ze},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[..._e],setup(e,{slots:i,emit:s,attrs:u}){let n,h;const t=Pe(),{proxy:{$q:r}}=t,l=x(null),a=x(!1),o=b(()=>Z(e.anchor,r.lang.rtl)),oe=b(()=>Z(e.self,r.lang.rtl)),ae=b(()=>e.persistent!==!0),{registerTick:le,removeTick:ne}=Se(),{registerTimeout:B}=ke(),{transitionProps:re,transitionStyle:se}=Ce(e),{localScrollTarget:Q,changeScrollEvent:ie,unconfigureScrollTarget:ue}=Le(e,z),{anchorEl:g,canShow:de,anchorEvents:_}=He({showing:a,configureAnchorEl:ye}),{show:ce,hide:P}=Te({showing:a,canShow:de,handleShow:fe,handleHide:ve,hideOnRouteChange:ae,processOnMount:!0});Object.assign(_,{delayShow:ge,delayHide:me});const{showPortal:U,hidePortal:D,renderPortal:he}=Be(t,l,we,"tooltip");if(r.platform.is.mobile===!0){const c={anchorEl:g,innerRef:l,onClickOutside(y){return P(y),y.target.classList.contains("q-dialog__backdrop")&&$e(y),!0}},N=b(()=>e.modelValue===null&&e.persistent!==!0&&a.value===!0);H(N,y=>{(y===!0?Ge:F)(c)}),M(()=>{F(c)})}function fe(c){U(),le(()=>{h=new MutationObserver(()=>S()),h.observe(l.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),S(),z()}),n===void 0&&(n=H(()=>r.screen.width+"|"+r.screen.height+"|"+e.self+"|"+e.anchor+"|"+r.lang.rtl,S)),B(()=>{U(!0),s("show",c)},e.transitionDuration)}function ve(c){ne(),D(),j(),B(()=>{D(!0),s("hide",c)},e.transitionDuration)}function j(){h!==void 0&&(h.disconnect(),h=void 0),n!==void 0&&(n(),n=void 0),ue(),G(_,"tooltipTemp")}function S(){Me({targetEl:l.value,offset:e.offset,anchorEl:g.value,anchorOrigin:o.value,selfOrigin:oe.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ge(c){if(r.platform.is.mobile===!0){K(),document.body.classList.add("non-selectable");const N=g.value,y=["touchmove","touchcancel","touchend","click"].map(L=>[N,L,"delayHide","passiveCapture"]);R(_,"tooltipTemp",y)}B(()=>{ce(c)},e.delay)}function me(c){r.platform.is.mobile===!0&&(G(_,"tooltipTemp"),K(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),B(()=>{P(c)},e.hideDelay)}function ye(){if(e.noParentEvent===!0||g.value===null)return;const c=r.platform.is.mobile===!0?[[g.value,"touchstart","delayShow","passive"]]:[[g.value,"mouseenter","delayShow","passive"],[g.value,"mouseleave","delayHide","passive"]];R(_,"anchor",c)}function z(){if(g.value!==null||e.scrollTarget!==void 0){Q.value=Ve(g.value,e.scrollTarget);const c=e.noParentEvent===!0?S:P;ie(Q.value,c)}}function be(){return a.value===!0?O("div",{...u,ref:l,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",u.class],style:[u.style,se.value],role:"tooltip"},Ne(i.default)):null}function we(){return O(qe,re.value,be)}return M(j),Object.assign(t.proxy,{updatePosition:S}),he}});const Ze=["top","middle","bottom"];var Fe=Y({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>Ze.includes(e)}},setup(e,{slots:i}){const s=b(()=>e.align!==void 0?{verticalAlign:e.align}:null),u=b(()=>{const n=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(n!==void 0?` text-${n}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>O("div",{class:u.value,style:s.value,role:"status","aria-label":e.label},Ee(i.default,e.label!==void 0?[e.label]:[]))}});const ee=J("user",()=>{const e=A(),i=q(),s=x([]);return{removeUser:async t=>{var r;try{i.loading.show({spinner:V,delay:300}),await $({method:"DELETE",url:`/users/${t}`,headers:{Authorization:"Bearer "+e.token}}),s.value=s.value.filter(l=>l.id!==t)}catch(l){throw((r=l.response)==null?void 0:r.data)||l}finally{i.loading.hide()}},modifiedUser:async t=>{var r;try{i.loading.show({spinner:V,delay:300}),await $({method:"PUT",url:`/users/${t.id}`,data:{usuario:t.usuario,rfc:t.rfc,email:t.email,idrol:t.idrol,rol:t.rol,dev_access:t.dev_access,beta_access:t.beta_access,prod_access:t.prod_access},headers:{Authorization:"Bearer "+e.token}}),s.value=s.value.map(l=>l.id===t.id?t:l);return}catch(l){throw((r=l.response)==null?void 0:r.data)||l}finally{i.loading.hide()}},getUsers:async(t,r)=>{var l;try{const a=t+","+r;return(await $({method:"GET",url:`/users/${a}`,headers:{Authorization:"Bearer "+e.token}})).data.users}catch(a){throw console.log(a),((l=a.response)==null?void 0:l.data)||a}}}}),te=J("infra",()=>{const e=x(!1);return{changeBox:async(s,u)=>{try{s===1&&(u==="close"?e.value=!1:u==="open"&&(e.value=!0));return}catch(n){console.log(n)}},userDialogBox:e}}),Ke=()=>{const e=q();return{showNotify:(n="Error de servidor",h="negative",t="report_problem")=>{e.notify({message:n,color:h,textColor:"white",icon:t,position:"top"})},errorNotify:(n="Error de servidor")=>{e.notify({message:n,color:"negative",textColor:"white",icon:"report_problem",position:"top"})},successNotify:(n="\xC9xito")=>{e.notify({message:n,color:"positive",textColor:"white",icon:"mdi-account-check",position:"top"})}}},Ye={style:{height:"50%",width:"50%","background-color":"white"}},Je={class:"new-user-header",style:{height:"10%",width:"100%","background-color":"#b16655",color:"white",display:"flex","align-items":"center"}},Xe={class:"new-user-body",style:{height:"80%",width:"100%"}},et={key:0,class:"new-user-body-international",style:{height:"100%",width:"100%",padding:"2.5%",display:"flex","flex-direction":"column","justify-content":"space-evenly"}},tt={class:"new-user-footer",style:{height:"10%",width:"100%",display:"flex","align-items":"center","justify-content":"space-evenly","border-top":"3px solid #b16655"}},ot={__name:"NewUser",setup(e){const i=q(),s=te(),u=A();ee();const{showNotify:n}=Ke(),h=[{value:2,label:"Nacional"},{value:3,label:"Regional"},{value:4,label:"Zona"},{value:5,label:"Parroquia"}],t=x({usuario:"",correo:"",nivel:"",contra:"",recontra:""}),r=async()=>{try{i.loading.show({spinner:V,delay:300}),await u.register(t.value),n("Registro de usuario exitoso!","positive","mdi-account-check");return}catch(l){console.log(l),n("No se cre\xF3 correctamente el usuario, favor de intentarlo nuevamente.","negative","mdi-account-remove")}finally{i.loading.hide(),s.changeBox(1,"close")}};return(l,a)=>(w(),C("div",Ye,[f("div",Je,[d(Ie,{style:{"text-align":"center","font-weight":"bold"}},{default:v(()=>[m(" Crear Usuario ")]),_:1})]),f("div",Xe,[p(u).profile.idnivel===1||p(u).profile.idnivel===0?(w(),C("div",et,[d(Re,{square:"",standout:"",label:"Nivel",options:h,modelValue:t.value.nivel,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.nivel=o)},null,8,["modelValue"]),d(k,{square:"",standout:"",label:"Usuario",modelValue:t.value.usuario,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.usuario=o),rules:[o=>o&&/^[A-Za-z]+$/.test(o)||"El nombre del usuario no debe contener n\xFAmeros.",o=>o.length>=8||"El nombre del usuario debe contener al menos 8 caract\xE9res."]},null,8,["modelValue","rules"]),d(k,{square:"",standout:"",label:"Correo",modelValue:t.value.correo,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.correo=o),rules:[o=>o&&/^[^@]+@[^@]+\.[a-zA-Z]{2,}$/.test(o)||"Formato de email incorrecto."]},null,8,["modelValue","rules"]),d(k,{square:"",type:"password",standout:"",label:"Contrase\xF1a",modelValue:t.value.contra,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.contra=o),rules:[o=>o.length>=8||"Contrase\xF1a debe contener al menos 8 caract\xE9res."]},null,8,["modelValue","rules"]),d(k,{square:"",type:"password",standout:"",label:"Confirmar Contrase\xF1a",modelValue:t.value.recontra,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.recontra=o),rules:[o=>o===t.value.contra||"Contrase\xF1a no coincide."]},null,8,["modelValue","rules"])])):X("",!0)]),f("div",tt,[d(T,{disable:t.value.contra!==t.value.recontra||t.value.usuario===""||t.value.nivel===""||t.value.contra.length<8,onClick:a[5]||(a[5]=async()=>await r()),style:{width:"33%",color:"white","background-color":"#b16655"}},{default:v(()=>[m(" Guardar ")]),_:1},8,["disable"]),d(T,{onClick:a[6]||(a[6]=o=>p(s).changeBox(1,"close")),style:{width:"33%",color:"white","background-color":"#b16655"}},{default:v(()=>[m(" Cancelar ")]),_:1})])]))}},at={class:"main-users-admin",style:{width:"100%",height:"100%",padding:"1%"}},lt={class:"search-bar",style:{height:"10%",width:"100%",display:"flex","align-items":"center"}},nt={style:{width:"50%",display:"flex","align-items":"center","justify-content":"space-evenly"}},rt={style:{width:"50%"}},st={style:{width:"50%",display:"flex","align-items":"center","justify-content":"end"}},it={class:"user-content",style:{height:"90%",width:"100%",display:"flex","overflow-y":"auto"}},ut={class:"user-card-header",style:{height:"25%",width:"100%","background-color":"white",color:"#b16655","font-size":"20px","font-weight":"bold",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center","border-radius":"0",border:"1px solid #b16655"}},dt={class:"user-card-detail",style:{height:"75%",width:"100%",padding:"3%"}},ct={key:0},bt={__name:"UsersAdmin",setup(e){const i=q(),s=te(),u=ee(),n=A(),h=b(()=>n.profile.idnivel),t=x([]),r=async()=>{try{i.loading.show({spinner:V,delay:300});const l={user:n.profile.id,nivel:h.value};t.value=await u.getUsers(h.value,n.profile.id),t.value.sort((a,o)=>a.idnivel.value-o.idnivel.value);return}catch(l){console.log(l)}finally{i.loading.hide()}};return Oe(async()=>{await r()}),(l,a)=>(w(),C(I,null,[f("div",at,[f("div",lt,[d(k,{square:"",standout:"",style:{width:"50%"}}),f("div",nt,[f("div",rt,[d(T,{onClick:a[0]||(a[0]=o=>p(s).changeBox(1,"open")),icon:"mdi-plus",rounded:"",style:{width:"7.5%",height:"7.5%","background-color":"#b16655",color:"white","font-size":"15px","font-weight":"bold","margin-left":"5%"}},{default:v(()=>[d(We,{style:{"font-size":"20px"}},{default:v(()=>[m("Crear nuevo usuario")]),_:1})]),_:1})]),f("div",st,[d(T,{style:{width:"35%","background-color":"#b16655",color:"white","font-size":"15px","font-weight":"bold"}},{default:v(()=>[m(" Guardar ")]),_:1}),d(T,{onClick:a[1]||(a[1]=async()=>await r()),style:{width:"35%","background-color":"#b16655",color:"white","font-size":"15px","font-weight":"bold","margin-left":"2.5%"}},{default:v(()=>[m(" Cancelar ")]),_:1})])])]),f("div",it,[(w(!0),C(I,null,Ae(t.value,o=>(w(),Ue(De,{key:o.id,class:"user-cards",style:{width:"20%",height:"35%",margin:"1%","background-color":"#b16655",color:"white",cursor:"pointer"}},{default:v(()=>[f("div",ut,[m(E(o.usuario)+" ",1),d(Fe,null,{default:v(()=>[m(E(o.idnivel.label),1)]),_:2},1024)]),f("div",dt,[o.idnivel.value===2?(w(),C("div",ct,E(o.email),1)):X("",!0)])]),_:2},1024))),128))])]),d(Qe,{modelValue:p(s).userDialogBox,"onUpdate:modelValue":a[2]||(a[2]=o=>p(s).userDialogBox=o),persistent:!0},{default:v(()=>[d(ot)]),_:1},8,["modelValue"])],64))}};export{bt as default};
